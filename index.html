<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>عرض نوع الاستجابة</title>
    <style>
        .response { margin-top: 20px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
        .json { background-color: #f0f0f0; }
        .text { background-color: #f8f8f8; }
        .error { color: red; background-color: #ffe6e6; }
        .success { color: green; background-color: #e6ffe6; }
    </style>
</head>
<body>
    <h1>اختبار نوع الاستجابة من الـ API</h1>

    <button id="testApiButton">اختبار API</button>

    <div id="responseInfo" class="response"></div>

    <script>
        document.getElementById('testApiButton').addEventListener('click', function() {
            // الرابط الذي سيتم اختباره
            const url = "https://cors-anywhere.herokuapp.com/https://00acc.com/api/createInvoice";  // مع CORS Anywhere
            
            // بناء البيانات (payload)
            const payload = {
                secretId: "je4dCacsUS1hIu28wsmr",
                price: 10,
                title: "testpostman",
                description: "this is test",
                accepts: { card: true, paypal: true, coinbase: false },
                acceptGuestPayment: true
            };

            // إرسال الطلب باستخدام fetch
            fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(payload)
            })
            .then(response => {
                // أولاً، عرض نوع الاستجابة
                const contentType = response.headers.get('Content-Type');
                const responseDiv = document.getElementById('responseInfo');

                responseDiv.innerHTML = `<p><strong>نوع الاستجابة:</strong> ${contentType}</p>`;

                if (contentType.includes('application/json')) {
                    // إذا كانت الاستجابة JSON، نعرضها بشكل مميز
                    return response.json().then(data => {
                        responseDiv.innerHTML += `<p><strong>محتوى الاستجابة (JSON):</strong> <pre>${JSON.stringify(data, null, 2)}</pre></p>`;
                    });
                } else if (contentType.includes('text/html')) {
                    // إذا كانت الاستجابة HTML
                    return response.text().then(data => {
                        responseDiv.innerHTML += `<p><strong>محتوى الاستجابة (HTML):</strong> <pre>${data}</pre></p>`;
                    });
                } else if (contentType.includes('text/plain')) {
                    // إذا كانت الاستجابة نصية
                    return response.text().then(data => {
                        responseDiv.innerHTML += `<p><strong>محتوى الاستجابة (نص عادي):</strong> <pre>${data}</pre></p>`;
                    });
                } else {
                    responseDiv.innerHTML += `<p class="error">استجابة غير متوقعة من الخادم.</p>`;
                    return Promise.reject("استجابة غير متوقعة");
                }
            })
            .catch(error => {
                // في حالة حدوث أي خطأ
                document.getElementById('responseInfo').innerHTML = `<p class="error">حدث خطأ أثناء الاتصال بالـ API: ${error}</p>`;
            });
        });
    </script>
</body>
</html>
